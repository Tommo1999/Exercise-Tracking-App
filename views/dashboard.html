<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Rep Dog Workout Tracker</title>
<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background-color: black;
  color: white;
}

.container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 30px 20px;
}

.header {
  text-align: center;
  margin-bottom: 40px;
}

.header h1 {
  font-size: 2.5rem;
  margin-bottom: 10px;
}

.dashboard-section {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 30px;
}

.card {
  background: grey;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  flex: 1 1 calc(50% - 20px); /* Initially takes 50% minus margin */
  min-width: 300px;  /* Ensures a minimum width */
  margin-bottom: 20px;

  /* Centering content */
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;

  /* Ensuring card is responsive */
  width: 100%; /* Allow the card to shrink */
  box-sizing: border-box; /* Ensure padding does not affect width */
}

/* Responsive adjustments for smaller screens */
@media (max-width: 768px) {
  .card {
    padding: 15px; /* Slightly reduce padding */
    flex: 1 1 calc(100% - 40px); /* Let card take 100% width on medium screens */
  }
}

@media (max-width: 480px) {
  .card {
    padding: 10px; /* Existing padding */
    margin: 0 15px 20px 15px; /* Add horizontal margin on phones */
  }
}
.card h2 {
  font-size: 1.5rem;
  margin-bottom: 10px;
}

/* Base Button Style */
.btn {
  background-color: #e74c3c; /* Original red */
  color: white;
  padding: 10px 15px;
  border: none;
  border-radius: 5px;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.3s;
}

/* Hover Effect - Orange */
.btn:hover {
  background-color: orange;
}

/* Layout Helpers */
.auth-buttons {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  margin-top: 20px;
}

.button-container {
  display: flex;
  gap: 10px;
}

/* Input, Select, and Textarea Styles */
input[type="text"],
input[type="number"],
input[type="date"],
input[type="email"],
input[type="password"],
select,
textarea {
  width: 100%;
  max-width: 350px;
  padding: 10px;
  font-size: 1rem;
  box-sizing: border-box;
  margin-bottom: 15px;
  border-radius: 4px;
  border: 1px solid #ccc;
  background-color: white;
  color: black;
}

textarea {
  height: 100px;
}

/* Password Eye Icon Styles */
.password-container {
  position: relative;
  width: 100%;
  max-width: 350px;
  margin-bottom: 15px;
}

.password-container input {
  padding-right: 35px;
}

.eye-icon {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  color: black;
  font-size: 20px;
}

/* Modal Overlay */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  background-color: rgba(0, 0, 0, 0.7); /* dark semi-transparent background */
  padding: 40px 10px; /* added horizontal padding for small screens */
}

/* Modal Content Box */
.modal-content {
  background-color: black;
  margin: auto;
  padding: 20px;
  border-radius: 10px;
  width: 100%;
  max-width: 600px;
  max-height: 90%;
  overflow-y: auto;
  box-sizing: border-box;
}

/* Close Button */
.modal .close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.modal .close:hover,
.modal .close:focus {
  color: orange;
  text-decoration: none;
  cursor: pointer;
}

/* Mobile Optimizations */
@media (max-width: 480px) {
  .modal-content {
    padding: 16px;
    border-radius: 8px;
    margin: 20px auto;
  }

  .modal {
    padding: 20px 5px;
  }
}
/* Table Styles */
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}

th {
  background-color: grey;
  color: white;
}

input[type="number"] {
  width: 70px;
  padding: 5px;
  font-size: 0.9rem;
}

.set-weight-dropdown {
  width: 80px;
  padding: 5px;
  font-size: 0.9rem;
}

/* Exercise Row Buttons */
#add-exercise-row-btn,
#save-workout-btn,
#edit-workout-btn,
#delete-workout-btn {
  background-color: #e74c3c;
}

#add-exercise-row-btn:hover,
#save-workout-btn:hover,
#edit-workout-btn:hover,
#delete-workout-btn:hover {
  background-color: orange; /* Hover color is orange */
}

/* Modal Label Styles */
.modal label {
  display: inline-block;
  margin-right: 10px;
  font-weight: bold;
}

.modal input[type="text"], .modal input[type="date"] {
  padding: 8px;
  font-size: 1rem;
  margin-bottom: 15px;
}

.exercise-row td:first-child input[type="text"] {
  font-size: 0.75rem;
  width: 100%;
  padding: 4px;
  max-width: 130px;
  box-sizing: border-box;
}

.exercise-row td:first-child {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.exercise-row td:first-child input[type="text"] {
  margin-top: 5px;
  width: 100%;
  font-size: 0.8rem;
  padding: 6px;
  text-align: center;
}

/* Modal Header Styles */
.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header .btn-container {
  display: flex;
  gap: 10px;
}

/* Horizontal Scroll Styles */
.horizontal-scroll {
  overflow-x: auto;
  width: 100%;
  margin-bottom: 20px;
}

.horizontal-scroll table {
  min-width: 1000px;
}

/* Modal Question Styles */
.modal .question {
  margin-bottom: 20px;
}

.modal .question input {
  padding: 8px;
  margin-top: 10px;
}

.modal .question select {
  padding: 8px;
  margin-top: 10px;
}

.modal .question textarea {
  padding: 8px;
  margin-top: 10px;
  width: 100%;
  height: 100px;
}

.modal label {
  display: block;
  text-align: left;
  margin-bottom: 5px;
  font-weight: bold;
}

/* Button Row Styles */
.button-row {
  display: flex;
  justify-content: space-between;
  margin-top: 1rem;
}

#download-btn {
  margin-right: auto;
}

#add-workout-btn {
  margin-left: auto;
}

</style>
  </head>
  <body>
<div class="auth-buttons">
  <div class="button-container">
    <button class="btn signup-btn">Sign Up</button>
    <button class="btn login-btn">Log In</button>
    <button class="btn logout" onclick="logout()">Log Out</button>
  </div>
  <div id="welcome-message" class="welcome-text"></div>
</div>


<!-- Login Modal -->
<div id="login-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-login-modal">&times;</span>
    <h2>Log In</h2>
    <form id="login-form">
      <!-- Username Input -->
      <label for="login-username">Username or Email:</label><br />
      <input type="text" id="login-username" required /><br /><br />

      <!-- Password Input -->
      <label for="login-password">Password:</label><br />
      <div class="password-container">
        <input type="password" id="login-password" required placeholder="Enter your password" />
        <span id="toggle-login-password" class="eye-icon">&#128065;</span> <!-- Eye icon for password visibility -->
      </div><br /><br />

      <!-- Submit Button -->
      <button type="submit" class="btn">Log In</button>
    </form>
  </div>
</div>

<!-- Signup Modal -->
<div id="signup-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-signup-modal">&times;</span>
    <h2>Sign Up</h2>
    <form id="signup-form">
      <!-- Username Input -->
      <label for="signup-username">Username:</label><br />
      <input type="text" id="signup-username" required placeholder="Enter your username" /><br /><br />

      <!-- Email Input -->
      <label for="signup-email">Email:</label><br />
      <input type="email" id="signup-email" required placeholder="Enter your email" /><br /><br />

      <!-- Password Input -->
      <label for="signup-password">Password:</label><br />
      <div class="password-container">
        <input type="password" id="signup-password" required placeholder="Enter your password" />
        <span id="toggle-signup-password" class="eye-icon">&#128065;</span> <!-- Eye icon to toggle visibility -->
      </div><br />

      <!-- Confirm Password Input -->
      <label for="signup-confirm-password">Confirm Password:</label><br />
      <div class="password-container">
        <input type="password" id="signup-confirm-password" required placeholder="Confirm your password" />
        <span id="toggle-confirm-password" class="eye-icon">&#128065;</span> <!-- Eye icon to toggle visibility -->
      </div><br />

      <!-- Submit Button -->
      <button type="submit" class="btn">Sign Up</button>
    </form>
  </div>
</div>

  <div class="container">
    <div class="header">
	<img src="../images/RepDog.png" alt="RepDog Logo" width="300" height="200" />

      <p>Track your workouts and fitness journey</p>
<button class="btn" id="add-workout-btn">Create Workout</button>
    </div>

   <div class="dashboard-section">
  <div class="card">
    <h2>Recent Workouts</h2>
<p> Click for workout details. </p>
    <p id="no-workouts" class="empty-message">No workouts added yet.</p>
    <ul id="recent-workouts-list" style="display: none;"></ul>


  </div>
</div>
  </div>

  <!-- Workout Details Modal (Popup) -->
  <div id="workout-details-modal" class="modal">
    <div id="workout-details-content" class="modal-content"></div>
    <button id="close-workout-details-modal">Close</button>
    <button id="edit-workout-btn" class="btn">Edit Workout</button>
    <button id="delete-workout-btn" class="btn">Delete Workout</button>
<div id="workout-details-modal" class="modal">
  <div id="workout-details-content" class="modal-content">
    <button class="close" id="close-workout-details-modal">&times;</button>
    <div id="workout-details-body"><!-- content injected via JS --></div>

    <div class="button-row">
      <button id="edit-workout-btn" class="btn btn-small">Edit Workout</button>
      <button id="delete-workout-btn" class="btn btn-small">Delete Workout</button>
    </div>
  </div>
</div>

  <!-- Workout Modal -->
  <div id="create-workout-modal" class="modal">
@@ -818,165 +822,165 @@
  `;

  // Inject content
  workoutDetailsContent.innerHTML = workoutDetails;
  document.getElementById("workout-details-body").innerHTML = workoutDetails;

  // Reattach close functionality since we injected new HTML
  document.getElementById("close-workout-details-modal").addEventListener("click", () => {
    workoutDetailsModal.style.display = "none";
    document.body.style.overflow = "";
  });

  // Show the modal
  workoutDetailsModal.style.display = "block";
  document.body.style.overflow = "hidden";
}

    // Save workout
    document.getElementById("save-workout-btn").addEventListener("click", () => {
      const workout = document.getElementById("workout-name").value.trim();
      const date = document.getElementById("workout-date").value;
      const progressYourLifts = document.querySelectorAll(".question select")[0].value;
      const progressForNextSession = document.querySelectorAll(".question select")[1].value;
      const workoutRating = parseInt(document.querySelectorAll(".question input[type='number']")[0].value) || null;
      const additionalNotes = document.querySelectorAll(".question textarea")[0].value;
      const cardio = document.querySelectorAll(".question textarea")[1].value;

      const exerciseRows = Array.from(document.querySelectorAll(".exercise-row"));
      const exercises = exerciseRows.map(row => {
        const name = row.querySelector("input[type='text']").value;
        const weightUnit = row.querySelector("select").value;
        const inputs = row.querySelectorAll("input[type='number']");

        const sets = [];
        for (let i = 0; i < inputs.length; i += 2) {
          const weight = parseFloat(inputs[i].value);
          const reps = parseInt(inputs[i + 1].value);
          if (!isNaN(weight) && !isNaN(reps)) {
            sets.push({ weight, reps });
          }
        }

        return { name, weightUnit, sets };
      }).filter(ex => ex.sets.length > 0 && ex.name);

      if (!username || !workout || !date || exercises.length === 0) {
        alert("Please fill in all required fields.");
        return;
      }

      const workoutData = {
        username,
        workout,
        date,
        exercises,
        progressYourLifts,
        progressForNextSession,
        workoutRating,
        additionalNotes,
        cardio,
      };

      fetch("/add-workout", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(workoutData)
      })
        .then(res => res.json())
        .then(data => {
          alert("Workout saved successfully!");
          console.log("Saved workout:", data);
          modal.style.display = "none";
          document.body.style.overflow = "";
          resetWorkoutForm();

          // Update recent workouts list immediately
          loadRecentWorkouts();
        })
        .catch(err => {
          console.error("Failed to save workout:", err);
          alert("Error saving workout. Check console for details.");
        });
    });

    function resetWorkoutForm() {
      document.getElementById("workout-name").value = "";
      document.getElementById("workout-date").value = "";
      exerciseRowsContainer.innerHTML = "";

      const row = document.createElement("tr");
      row.className = "exercise-row";
      row.setAttribute("data-index", "0");
      row.innerHTML = ` 
        <td><strong>A.</strong>
          <input type="text" placeholder="Exercise name" />
        </td>
        <td>
          <select class="set-weight-dropdown">
            <option value="kg">kg</option>
            <option value="lbs">lbs</option>
          </select>
        </td>
        ${[...Array(6)].map(() => `
          <td><input type="number" placeholder="Weight" /></td>
          <td><input type="number" placeholder="Reps" /></td>
        `).join("")}
      `;
      exerciseRowsContainer.appendChild(row);
    }

    addWorkoutBtn.addEventListener("click", () => {
      modal.style.display = "block";
      document.body.style.overflow = "hidden";
    });

    closeModal.addEventListener("click", () => {
      modal.style.display = "none";
      document.body.style.overflow = "";
    });

    window.addEventListener("click", (event) => {
      if (event.target === modal) {
        modal.style.display = "none";
        document.body.style.overflow = "";
      }
    });

    addExerciseRowBtn.addEventListener("click", () => {
      const index = exerciseRowsContainer.children.length;
      const row = document.createElement("tr");
      row.className = "exercise-row";
      row.setAttribute("data-index", index);
      row.innerHTML = `
        <td><strong>${String.fromCharCode(65 + index)}.</strong>
          <input type="text" placeholder="Exercise name" />
        </td>
        <td>
          <select class="set-weight-dropdown">
            <option value="kg">kg</option>
            <option value="lbs">lbs</option>
          </select>
        </td>
        ${[...Array(6)].map(() => `
          <td><input type="number" placeholder="Weight" /></td>
          <td><input type="number" placeholder="Reps" /></td>
        `).join("")}
      `;
      exerciseRowsContainer.appendChild(row);
    });

    const logoutBtn = document.querySelector(".logout");
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("username");
      updateWelcomeMessage(); //reset welcome message
   recentWorkoutsList.innerHTML = ""; // Clear the list
   noWorkoutsMessage.style.display = "block"; // Show the "no workouts" message
   recentWorkoutsList.style.display = "none"; // Hide the workouts list
    });

    // Auto-load recent workouts on page load
    loadRecentWorkouts();
  });

  </script>

  </body>